#!/usr/bin/env python2
## -*- coding: utf-8 -*-
##
## Triton
##

import sys
import z3

def sx(bits, value):
    sign_bit = 1 << (bits - 1)
    return (value & (sign_bit - 1)) - (value & sign_bit)

ctx = z3.Context()
s   = z3.Solver()

SymVar_0 = z3.BitVec('SymVar_0', 64)

guard_326 = SymVar_0
guard_341 = guard_326 # MOV operation
guard_29553 = guard_341 # MOV operation
guard_29785 = guard_29553 # MOV operation
guard_29801 = (0x6EF7C230000 | guard_29785) # OR operation
guard_32122 = guard_29801 # MOV operation
guard_34635 = guard_341 # MOV operation
guard_34867 = guard_34635 # MOV operation
guard_34883 = guard_34867 # MOV operation
guard_34885 = ((guard_34883 - 0x41F9A357) & 0xFFFFFFFFFFFFFFFF) # SUB operation
guard_34893 = guard_34885 # MOV operation
guard_37209 = guard_34893 # MOV operation
guard_39442 = guard_341 # MOV operation
guard_39962 = guard_39442 # MOV operation
guard_39970 = guard_39962 # MOV operation
guard_39974 = (guard_39970 >> (0x31 & 0x3F)) # SHR operation
guard_39981 = guard_39974 # MOV operation
guard_42476 = guard_341 # MOV operation
guard_42746 = guard_42476 # MOV operation
guard_42762 = guard_42746 # MOV operation
guard_42766 = ((guard_42762 << (0xF & 0x3F)) & 0xFFFFFFFFFFFFFFFF) # SHL operation
guard_42773 = guard_42766 # MOV operation
guard_43045 = guard_42773 # MOV operation
guard_43059 = guard_39981 # MOV operation
guard_43061 = (guard_43059 | guard_43045) # OR operation
guard_45362 = guard_43061 # MOV operation
guard_47567 = guard_341 # MOV operation
guard_50433 = guard_37209 # MOV operation
guard_50969 = guard_50433 # MOV operation
guard_50977 = guard_50969 # MOV operation
guard_50981 = (guard_50977 >> (0x3 & 0x3F)) # SHR operation
guard_50988 = guard_50981 # MOV operation
guard_51274 = guard_50988 # MOV operation
guard_51290 = (0x7 & guard_51274) # AND operation
guard_51571 = guard_51290 # MOV operation
guard_51587 = (0x1 | guard_51571) # OR operation
guard_51880 = guard_47567 # MOV operation
guard_51886 = guard_51587 # MOV operation
guard_51888 = guard_51880 # MOV operation
guard_51890 = (guard_51886 & 0xFFFFFFFF) # MOV operation
guard_51892 = (guard_51888 >> ((guard_51890 & 0xFF) & 0x3F)) # SHR operation
guard_51899 = guard_51892 # MOV operation
guard_54177 = guard_45362 # MOV operation
guard_56459 = guard_32122 # MOV operation
guard_56717 = guard_56459 # MOV operation
guard_56731 = guard_54177 # MOV operation
guard_56733 = (guard_56731 & guard_56717) # AND operation
guard_57026 = guard_51899 # MOV operation
guard_57032 = guard_56733 # MOV operation
guard_57034 = ((sx(0x40, guard_57032) * sx(0x40, guard_57026)) & 0xFFFFFFFFFFFFFFFF) # IMUL operation
guard_59322 = guard_57034 # MOV operation
guard_62214 = guard_45362 # MOV operation
guard_62464 = guard_62214 # MOV operation
guard_62480 = (0x3F & guard_62464) # AND operation
guard_62735 = guard_62480 # MOV operation
guard_62751 = guard_62735 # MOV operation
guard_62755 = ((guard_62751 << (0x4 & 0x3F)) & 0xFFFFFFFFFFFFFFFF) # SHL operation
guard_62762 = guard_62755 # MOV operation
guard_65076 = guard_37209 # MOV operation
guard_65320 = guard_65076 # MOV operation
guard_65334 = guard_62762 # MOV operation
guard_65336 = (guard_65334 | guard_65320) # OR operation
guard_67657 = guard_65336 # MOV operation
guard_70213 = guard_45362 # MOV operation
guard_72497 = guard_59322 # MOV operation
guard_72755 = guard_70213 # MOV operation
guard_72761 = guard_72497 # MOV operation
guard_72763 = ((sx(0x40, guard_72761) * sx(0x40, guard_72755)) & 0xFFFFFFFFFFFFFFFF) # IMUL operation
guard_75047 = guard_32122 # MOV operation
guard_77333 = guard_67657 # MOV operation
guard_77603 = guard_75047 # MOV operation
guard_77609 = guard_77333 # MOV operation
guard_77611 = ((sx(0x40, guard_77609) * sx(0x40, guard_77603)) & 0xFFFFFFFFFFFFFFFF) # IMUL operation
guard_77881 = guard_77611 # MOV operation
guard_77895 = guard_72763 # MOV operation
guard_77897 = ((guard_77881 - guard_77895) & 0xFFFFFFFFFFFFFFFF) # CMP operation
guard_77899 = ((((guard_77881 ^ (guard_77895 ^ guard_77897)) ^ ((guard_77881 ^ guard_77897) & (guard_77881 ^ guard_77895))) >> 63) & 0x1) # Carry flag
guard_77903 = (0x1 if (guard_77897 == 0x0) else 0x0) # Zero flag
guard_77905 = ((((guard_77895 >> 8) & 0xFFFFFFFFFFFFFF)) << 8 | (0x1 if (((~(guard_77899 & 0x1) & 0x1) & (~(guard_77903 & 0x1) & 0x1)) == 0x1) else 0x0)) # SETA operation
guard_77907 = (guard_77905 & 0xFF) # MOVZX operation
guard_78425 = (guard_77907 & 0xFFFFFFFF) # MOV operation
guard_78433 = (((guard_78425 & 0xFFFFFFFF) - 0x0) & 0xFFFFFFFF) # CMP operation
guard_78439 = (0x1 if ((guard_78433 & 0xFFFFFFFF) == 0x0) else 0x0) # Zero flag
guard_78441 = ((((0x0 >> 8) & 0xFFFFFFFFFFFFFF)) << 8 | (0x1 if ((guard_78439 & 0x1) == 0x0) else 0x0)) # SETNE operation
guard_78443 = (guard_78441 & 0xFF) # MOVZX operation
guard_79320 = (guard_78443 & 0xFFFFFFFF) # MOV operation
guard_79322 = ((guard_79320 & 0xFFFFFFFF) & (guard_79320 & 0xFFFFFFFF)) # TEST operation
guard_79327 = (0x1 if ((guard_79322 & 0xFFFFFFFF) == 0x0) else 0x0) # Zero flag

branch1_326 = SymVar_0
branch1_341 = branch1_326 # MOV operation
branch1_29553 = branch1_341 # MOV operation
branch1_29785 = branch1_29553 # MOV operation
branch1_29801 = (0x6EF7C230000 | branch1_29785) # OR operation
branch1_32122 = branch1_29801 # MOV operation
branch1_34635 = branch1_341 # MOV operation
branch1_34867 = branch1_34635 # MOV operation
branch1_34883 = branch1_34867 # MOV operation
branch1_34885 = ((branch1_34883 - 0x41F9A357) & 0xFFFFFFFFFFFFFFFF) # SUB operation
branch1_34893 = branch1_34885 # MOV operation
branch1_37209 = branch1_34893 # MOV operation
branch1_39442 = branch1_341 # MOV operation
branch1_39962 = branch1_39442 # MOV operation
branch1_39970 = branch1_39962 # MOV operation
branch1_39974 = (branch1_39970 >> (0x31 & 0x3F)) # SHR operation
branch1_39981 = branch1_39974 # MOV operation
branch1_42476 = branch1_341 # MOV operation
branch1_42746 = branch1_42476 # MOV operation
branch1_42762 = branch1_42746 # MOV operation
branch1_42766 = ((branch1_42762 << (0xF & 0x3F)) & 0xFFFFFFFFFFFFFFFF) # SHL operation
branch1_42773 = branch1_42766 # MOV operation
branch1_43045 = branch1_42773 # MOV operation
branch1_43059 = branch1_39981 # MOV operation
branch1_43061 = (branch1_43059 | branch1_43045) # OR operation
branch1_45362 = branch1_43061 # MOV operation
branch1_47567 = branch1_341 # MOV operation
branch1_50433 = branch1_37209 # MOV operation
branch1_50969 = branch1_50433 # MOV operation
branch1_50977 = branch1_50969 # MOV operation
branch1_50981 = (branch1_50977 >> (0x3 & 0x3F)) # SHR operation
branch1_50988 = branch1_50981 # MOV operation
branch1_51274 = branch1_50988 # MOV operation
branch1_51290 = (0x7 & branch1_51274) # AND operation
branch1_51571 = branch1_51290 # MOV operation
branch1_51587 = (0x1 | branch1_51571) # OR operation
branch1_51880 = branch1_47567 # MOV operation
branch1_51886 = branch1_51587 # MOV operation
branch1_51888 = branch1_51880 # MOV operation
branch1_51890 = (branch1_51886 & 0xFFFFFFFF) # MOV operation
branch1_51892 = (branch1_51888 >> ((branch1_51890 & 0xFF) & 0x3F)) # SHR operation
branch1_51899 = branch1_51892 # MOV operation
branch1_54177 = branch1_45362 # MOV operation
branch1_56459 = branch1_32122 # MOV operation
branch1_56717 = branch1_56459 # MOV operation
branch1_56731 = branch1_54177 # MOV operation
branch1_56733 = (branch1_56731 & branch1_56717) # AND operation
branch1_57026 = branch1_51899 # MOV operation
branch1_57032 = branch1_56733 # MOV operation
branch1_57034 = ((sx(0x40, branch1_57032) * sx(0x40, branch1_57026)) & 0xFFFFFFFFFFFFFFFF) # IMUL operation
branch1_59322 = branch1_57034 # MOV operation
branch1_62214 = branch1_45362 # MOV operation
branch1_62464 = branch1_62214 # MOV operation
branch1_62480 = (0x3F & branch1_62464) # AND operation
branch1_62735 = branch1_62480 # MOV operation
branch1_62751 = branch1_62735 # MOV operation
branch1_62755 = ((branch1_62751 << (0x4 & 0x3F)) & 0xFFFFFFFFFFFFFFFF) # SHL operation
branch1_62762 = branch1_62755 # MOV operation
branch1_65076 = branch1_37209 # MOV operation
branch1_65320 = branch1_65076 # MOV operation
branch1_65334 = branch1_62762 # MOV operation
branch1_65336 = (branch1_65334 | branch1_65320) # OR operation
branch1_67657 = branch1_65336 # MOV operation
branch1_82492 = branch1_32122 # MOV operation
branch1_82754 = branch1_82492 # MOV operation
branch1_82770 = (0xF & branch1_82754) # AND operation
branch1_83043 = branch1_82770 # MOV operation
branch1_83059 = branch1_83043 # MOV operation
branch1_83063 = ((branch1_83059 << (0x2 & 0x3F)) & 0xFFFFFFFFFFFFFFFF) # SHL operation
branch1_83070 = branch1_83063 # MOV operation
branch1_85352 = branch1_59322 # MOV operation
branch1_85616 = branch1_85352 # MOV operation
branch1_85630 = branch1_83070 # MOV operation
branch1_85632 = (branch1_85630 | branch1_85616) # OR operation
branch1_87947 = branch1_85632 # MOV operation
branch1_87949 = ((branch1_87947 >> 56) & 0xFF) # Byte reference - MOV operation
branch1_87950 = ((branch1_87947 >> 48) & 0xFF) # Byte reference - MOV operation
branch1_87951 = ((branch1_87947 >> 40) & 0xFF) # Byte reference - MOV operation
branch1_87952 = ((branch1_87947 >> 32) & 0xFF) # Byte reference - MOV operation
branch1_87953 = ((branch1_87947 >> 24) & 0xFF) # Byte reference - MOV operation
branch1_87954 = ((branch1_87947 >> 16) & 0xFF) # Byte reference - MOV operation
branch1_87955 = ((branch1_87947 >> 8) & 0xFF) # Byte reference - MOV operation
branch1_87956 = (branch1_87947 & 0xFF) # Byte reference - MOV operation
branch1_91885 = (((((branch1_87953 & 0xFF)) << 8 | (branch1_87954 & 0xFF)) << 8 | (branch1_87955 & 0xFF)) << 8 | (branch1_87956 & 0xFF)) # MOV operation
branch1_92427 = (branch1_91885 & 0xFFFFFFFF) # MOV operation
branch1_96357 = (((((branch1_87949 & 0xFF)) << 8 | (branch1_87950 & 0xFF)) << 8 | (branch1_87951 & 0xFF)) << 8 | (branch1_87952 & 0xFF)) # MOV operation
branch1_100297 = (branch1_96357 & 0xFFFFFFFF) # MOV operation
branch1_100877 = (branch1_92427 & 0xFFFFFFFF) # MOV operation
branch1_104818 = (branch1_100877 & 0xFFFFFFFF) # MOV operation
branch1_108733 = (branch1_104818 & 0xFFFFFFFF) # MOV operation
branch1_109287 = (branch1_108733 & 0xFFFFFFFF) # MOV operation
branch1_113247 = (branch1_100297 & 0xFFFFFFFF) # MOV operation
branch1_117171 = (branch1_113247 & 0xFFFFFFFF) # MOV operation
branch1_117723 = (branch1_109287 & 0xFFFFFFFF) # MOV operation
branch1_121643 = (branch1_117723 & 0xFFFFFFFF) # MOV operation
branch1_125593 = (branch1_117171 & 0xFFFFFFFF) # MOV operation
branch1_126163 = (branch1_125593 & 0xFFFFFFFF) # MOV operation
branch1_130114 = (branch1_121643 & 0xFFFFFFFF) # MOV operation
branch1_134019 = (branch1_130114 & 0xFFFFFFFF) # MOV operation
branch1_134583 = (branch1_126163 & 0xFFFFFFFF) # MOV operation
branch1_138533 = (branch1_134583 & 0xFFFFFFFF) # MOV operation
branch1_142467 = (branch1_138533 & 0xFFFFFFFF) # MOV operation
branch1_143009 = (branch1_142467 & 0xFFFFFFFF) # MOV operation
branch1_146939 = (branch1_134019 & 0xFFFFFFFF) # MOV operation
branch1_150879 = (branch1_146939 & 0xFFFFFFFF) # MOV operation
branch1_150881 = (((branch1_150879 & 0xFFFFFFFF) >> 24) & 0xFF) # Byte reference - MOV operation
branch1_150882 = (((branch1_150879 & 0xFFFFFFFF) >> 16) & 0xFF) # Byte reference - MOV operation
branch1_150883 = (((branch1_150879 & 0xFFFFFFFF) >> 8) & 0xFF) # Byte reference - MOV operation
branch1_150884 = ((branch1_150879 & 0xFFFFFFFF) & 0xFF) # Byte reference - MOV operation
branch1_151459 = (branch1_143009 & 0xFFFFFFFF) # MOV operation
branch1_155400 = (branch1_151459 & 0xFFFFFFFF) # MOV operation
branch1_155402 = (((branch1_155400 & 0xFFFFFFFF) >> 24) & 0xFF) # Byte reference - MOV operation
branch1_155403 = (((branch1_155400 & 0xFFFFFFFF) >> 16) & 0xFF) # Byte reference - MOV operation
branch1_155404 = (((branch1_155400 & 0xFFFFFFFF) >> 8) & 0xFF) # Byte reference - MOV operation
branch1_155405 = ((branch1_155400 & 0xFFFFFFFF) & 0xFF) # Byte reference - MOV operation
branch1_157913 = (((((((((branch1_155402 & 0xFF)) << 8 | (branch1_155403 & 0xFF)) << 8 | (branch1_155404 & 0xFF)) << 8 | (branch1_155405 & 0xFF)) << 8 | (branch1_150881 & 0xFF)) << 8 | (branch1_150882 & 0xFF)) << 8 | (branch1_150883 & 0xFF)) << 8 | (branch1_150884 & 0xFF)) # MOV operation
branch1_160213 = branch1_45362 # MOV operation
branch1_160486 = branch1_160213 # MOV operation
branch1_160500 = branch1_157913 # MOV operation
branch1_160502 = branch1_160486 # MOV operation
branch1_160504 = ((branch1_160502 - branch1_160500) & 0xFFFFFFFFFFFFFFFF) # SUB operation
branch1_160512 = branch1_160504 # MOV operation
branch1_162797 = branch1_67657 # MOV operation
branch1_165065 = branch1_32122 # MOV operation
branch1_165319 = branch1_165065 # MOV operation
branch1_165333 = branch1_162797 # MOV operation
branch1_165335 = (branch1_165333 ^ branch1_165319) # XOR operation
branch1_165631 = branch1_165335 # MOV operation
branch1_165645 = branch1_160512 # MOV operation
branch1_165647 = (branch1_165645 | branch1_165631) # OR operation
branch1_167873 = branch1_165647 # MOV operation
branch1_168427 = branch1_167873 # MOV operation

branch2_326 = SymVar_0
branch2_341 = branch2_326 # MOV operation
branch2_29553 = branch2_341 # MOV operation
branch2_29785 = branch2_29553 # MOV operation
branch2_29801 = (0x6EF7C230000 | branch2_29785) # OR operation
branch2_32122 = branch2_29801 # MOV operation
branch2_34635 = branch2_341 # MOV operation
branch2_34867 = branch2_34635 # MOV operation
branch2_34883 = branch2_34867 # MOV operation
branch2_34885 = ((branch2_34883 - 0x41F9A357) & 0xFFFFFFFFFFFFFFFF) # SUB operation
branch2_34893 = branch2_34885 # MOV operation
branch2_37209 = branch2_34893 # MOV operation
branch2_39442 = branch2_341 # MOV operation
branch2_39962 = branch2_39442 # MOV operation
branch2_39970 = branch2_39962 # MOV operation
branch2_39974 = (branch2_39970 >> (0x31 & 0x3F)) # SHR operation
branch2_39981 = branch2_39974 # MOV operation
branch2_42476 = branch2_341 # MOV operation
branch2_42746 = branch2_42476 # MOV operation
branch2_42762 = branch2_42746 # MOV operation
branch2_42766 = ((branch2_42762 << (0xF & 0x3F)) & 0xFFFFFFFFFFFFFFFF) # SHL operation
branch2_42773 = branch2_42766 # MOV operation
branch2_43045 = branch2_42773 # MOV operation
branch2_43059 = branch2_39981 # MOV operation
branch2_43061 = (branch2_43059 | branch2_43045) # OR operation
branch2_45362 = branch2_43061 # MOV operation
branch2_47567 = branch2_341 # MOV operation
branch2_50433 = branch2_37209 # MOV operation
branch2_50969 = branch2_50433 # MOV operation
branch2_50977 = branch2_50969 # MOV operation
branch2_50981 = (branch2_50977 >> (0x3 & 0x3F)) # SHR operation
branch2_50988 = branch2_50981 # MOV operation
branch2_51274 = branch2_50988 # MOV operation
branch2_51290 = (0x7 & branch2_51274) # AND operation
branch2_51571 = branch2_51290 # MOV operation
branch2_51587 = (0x1 | branch2_51571) # OR operation
branch2_51880 = branch2_47567 # MOV operation
branch2_51886 = branch2_51587 # MOV operation
branch2_51888 = branch2_51880 # MOV operation
branch2_51890 = (branch2_51886 & 0xFFFFFFFF) # MOV operation
branch2_51892 = (branch2_51888 >> ((branch2_51890 & 0xFF) & 0x3F)) # SHR operation
branch2_51899 = branch2_51892 # MOV operation
branch2_54177 = branch2_45362 # MOV operation
branch2_56459 = branch2_32122 # MOV operation
branch2_56717 = branch2_56459 # MOV operation
branch2_56731 = branch2_54177 # MOV operation
branch2_56733 = (branch2_56731 & branch2_56717) # AND operation
branch2_57026 = branch2_51899 # MOV operation
branch2_57032 = branch2_56733 # MOV operation
branch2_57034 = ((sx(0x40, branch2_57032) * sx(0x40, branch2_57026)) & 0xFFFFFFFFFFFFFFFF) # IMUL operation
branch2_59322 = branch2_57034 # MOV operation
branch2_62214 = branch2_45362 # MOV operation
branch2_62464 = branch2_62214 # MOV operation
branch2_62480 = (0x3F & branch2_62464) # AND operation
branch2_62735 = branch2_62480 # MOV operation
branch2_62751 = branch2_62735 # MOV operation
branch2_62755 = ((branch2_62751 << (0x4 & 0x3F)) & 0xFFFFFFFFFFFFFFFF) # SHL operation
branch2_62762 = branch2_62755 # MOV operation
branch2_65076 = branch2_37209 # MOV operation
branch2_65320 = branch2_65076 # MOV operation
branch2_65334 = branch2_62762 # MOV operation
branch2_65336 = (branch2_65334 | branch2_65320) # OR operation
branch2_67657 = branch2_65336 # MOV operation
branch2_82150 = branch2_59322 # MOV operation
branch2_84455 = branch2_45362 # MOV operation
branch2_84673 = branch2_84455 # MOV operation
branch2_84687 = branch2_82150 # MOV operation
branch2_84689 = branch2_84673 # MOV operation
branch2_84691 = ((branch2_84689 - branch2_84687) & 0xFFFFFFFFFFFFFFFF) # SUB operation
branch2_84699 = branch2_84691 # MOV operation
branch2_86988 = branch2_67657 # MOV operation
branch2_89288 = branch2_32122 # MOV operation
branch2_89561 = branch2_89288 # MOV operation
branch2_89575 = branch2_86988 # MOV operation
branch2_89577 = (branch2_89575 ^ branch2_89561) # XOR operation
branch2_89818 = branch2_89577 # MOV operation
branch2_89832 = branch2_84699 # MOV operation
branch2_89834 = (branch2_89832 | branch2_89818) # OR operation
branch2_92064 = branch2_89834 # MOV operation
branch2_92654 = branch2_92064 # MOV operation

s.add(z3.If((guard_79327 & 0x1) == 0x1, branch1_168427, branch2_92654) == int(sys.argv[1]))

collisions = 0
while s.check() == z3.sat and collisions < 10:
    print s.model()
    s.add(SymVar_0 != s.model()[SymVar_0])
    collisions += 1
